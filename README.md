# INVOICE Google Apps Script

## Опис

**INVOICE** — це набір Google Apps Script для автоматизації роботи з інвентаризаційними накладними у Google Таблицях. Скрипти допомагають вести облік майна, автоматично розраховувати суми, експортувати накладні у PDF/Excel, контролювати ліміти та вести журнал експортів.

---

## Основні можливості

- **Додавання/видалення рядків товарів:**  
  Швидко додавайте або видаляйте рядки у накладній за допомогою меню.

- **Автоматичний контроль лімітів:**  
  При введенні кількості перевіряється максимальний дозволений ліміт по категоріях майна із "Довідника".

- **Конвертація чисел у слова:**  
  Автоматично перетворює кількість та суму у текст українською (наприклад, "сто двадцять три гривні").

- **Експорт накладної:**  
  Генеруйте PDF чи Excel-файл накладної одним кліком, із автоматичною реєстрацією у книзі здачі/видачі.

- **Автоматичне заповнення ПІБ, звань та підрозділів:**  
  Після вибору підрозділу автоматично підставляються відповідальні особи.

- **Зручне меню:**  
  Весь функціонал доступний через окреме меню у Google Таблицях.

---

## Огляд скриптів

- **add.js**  
  - `addProductRow()` — додає новий рядок товару, копіює форматування та формули.
  - `deleteProductRow()` — видаляє останній заповнений рядок товару.

- **createTable.js**  
  - `createSnapshotSpreadsheet()` — створює копію накладної та довідника для експорту.
  - `exportA4219ToPDF()` — експортує накладну у PDF, записує інформацію у лог.
  - `exportA4219ToExcel()` — експортує накладну у Excel.
  - `logExport()` — веде журнал експортованих документів.
  - `registerDocumentInBook()` — реєструє створений документ у книзі видачі/здачі.

- **ImportToSnapshot.js**  
  - `copyImportToSnapshot()` — копіює дані з листа "Довідник" у технічний лист "crit", який використовується для експорту.

- **numberToWordsUa.js**  
  - `onEdit(e)` — основна функція-обробник змін:  
    - Контролює ліміти по кількості.
    - Оновлює суму та кількість у словах.
    - Автоматично підбирає відповідальних осіб по підрозділах.
  - `updateWordsFieldsDynamic()` — оновлює текстовий запис суми та кількості.
  - `numberToWordsUa(number)` — переводить число у слова (українською).
  - `kopiykyWordsOnlyUa(number)` — переводить копійки у слова.
  - Допоміжні функції для пошуку та заповнення даних.

- **menu.js**  
  - `onOpen()` — додає кастомне меню до Google Таблиці для зручного доступу до всіх функцій.

---

## Як почати користуватись

1. **Створіть Google Таблицю** із такими листами:
    - `А4219` — основна накладна
    - `Довідник` — довідник майна
    - `МВО` — список відповідальних осіб та підрозділів
    - `crit` — технічний лист (створюється автоматично)
    - `Export_Log` — журнал експортів (створюється автоматично)

2. **Додайте скрипти** у редактор Apps Script (кожен файл окремо).

3. **Надайте необхідні дозволи** (Google Drive, таблиці).

4. **Відкрийте таблицю** — з’явиться меню "⚙️ Меню".

5. **Користуйтеся меню** для додавання/видалення рядків, розрахунків та експорту.

---

## Приклад структури проекту

```
INVOICE/
├── add.js
├── createTable.js
├── ImportToSnapshot.js
├── menu.js
├── numberToWordsUa.js
├── README.md
├── LICENSE
└── CONTRIBUTING.md
```

---

## Контакт

З питань по роботі або пропозицій:  

---

## Ліцензія

Проєкт поширюється за ліцензією MIT. Деталі — у [LICENSE](LICENSE).
